\subsection{Orthogonality of Eigenfunctions}
Suppose \( \mathcal L y_n = \lambda_n w y_n \), and \( \mathcal L y_m = \lambda_m w y_m \) where \( \lambda_n \neq \lambda_m \).
Then, we can integrate to find
\[
	\int_a^b (y_m \mathcal L y_n - y_n \mathcal L y_m) \dd{x} = (\lambda_n - \lambda_m) \int_a^b w y_n y_m \dd{x} = 0 \text{ by self-adjointness}
\]
Since \( \lambda_n \neq \lambda_m \), we have
\[
	\forall n \neq m, \int_a^b w y_n y_m \dd{x} = 0
\]
Hence, \( y_n \) and \( y_m \) are orthogonal \textit{with respect to} the weight function \( w \) on \( [a,b] \).
\begin{definition}
	We define the inner product with respect to \( w \) to be
	\[
		\inner{f,g}_w = \int_a^b w f^\star g \dd{x}
	\]
	Note,
	\[
		\inner{f,g}_w = \inner{wf,g} = \inner{f,wg}
	\]
\end{definition}
Hence, the orthogonality relation becomes
\[
	\forall n \neq m, \inner{y_n, y_m}_w = 0
\]

\subsection{Eigenfunction Expansions}
The completeness of the family of eigenfunctions (which is not proven here) implies that we can approximate any `well-behaved' \( f(x) \) on \( [a,b] \) by the series
\[
	f(x) = \sum_{n=1}^\infty a_n y_n(x)
\]
This is comparable to Fourier series.
To find the coefficients \( a_n \), we will take the inner product with an eigenfunction.
By orthogonality,
\[
	\int_a^b w y_m f \dd{x} = \sum_{n=1}^\infty a_n \int_a^b w y_n y_m \dd{x} = a_m \int_a^b w y_m^2 \dd{x}
\]
Hence,
\[
	a_n = \frac{\int_a^b w y_n f \dd{x}}{\int_a^b w y_n^2 \dd{x}}
\]
We can normalise eigenfunctions, for instance
\[
	Y_n(x) = \frac{y_n(x)}{\qty(\int_a^b w y_n^2 \dd{x})^{\frac{1}{2}}}
\]
hence
\[
	\inner{Y_n, Y_m}_w = \delta_{nm}
\]
giving an orthonormal set of eigenfunctions.
In this case,
\[
	f(x) = \sum_{n=1}^\infty A_n Y_n
\]
where
\[
	A_n = \int_a^b w Y_n f \dd{x}
\]
\begin{example}
	Recall Fourier series in Sturm-Liouville form:
	\[
		\mathcal L y_n \equiv - \dv[2]{y}{x} = \lambda_n y_n
	\]
	where in this case we have
	\[
		\lambda_n = \qty(\frac{n \pi}{L})^2
	\]
\end{example}

\subsection{Completeness and Parseval's Identity}
Consider
\[
	\int_a^b \qty[ f(x) - \sum{n=1}^\infty a_n y_n ]^2 w \dd{x}
\]
By orthogonality, this is equivalently
\[
	\int_a^b \qty[ f^2 - 2 f \sum_n a_n y_n + \sum_n a_n^2 y_n^2 ] w \dd{x}
\]
Note that the second term can be extracted using the definition of \( a_n \), giving
\[
	\int_a^b wf^2 \dd{x} - \sum_{n=1}^\infty a_n^2 \int_a^b w y_n^2 \dd{x}
\]
If the eigenfunctions are complete, then the result will be zero, showing that the series expansion converges.
\[
	\int_a^b w f^2 \dd{x} = \sum_{n=1}^\infty a_n^2 \int_a^b w y_n^2 \dd{x} = \sum_{n=1}^\infty A_n^2
\]
If some eigenfunctions are missing, this is Bessel's inequality:
\[
	\int_a^b w f^2 \dd{x} \geq \sum_{n=1}^\infty A_n^2
\]
We define the partial sum to be
\[
	S_N(x) = \sum_{n=1}^N a_n y_n
\]
with \( f(x) = \lim_{N \to \infty} S_N(x) \).
Convergence is defined to in terms of the mean-square error.
In particular, if we have a complete set of eigenfunctions,
\[
	\varepsilon_N = \int_a^b w \qty[f(x) - S_n(x)]^2 \dd{x} \to 0
\]
This `global' definition of convergence is convergence in the mean, not pointwise convergence as in Fourier series.
The error in partial sum \( S_N \) is minimised by \( a_n \) above for the \( N = \infty \) expansion.
\[
	\pdv{\varepsilon_N}{a_n} = -2 \int_a^b y_n w \qty[ f - \sum_{n=1}^N a_n y_n ] \dd{x} = -2 \int_a^b \qty(wfy_n - a_n w y_n^2) \dd{x} = 0
\]
It is minimal because we can show \( \pdv[2]{\varepsilon}{a_n} = 2 \int_a^b w y_n^2 \dd{x} \geq 0 \).
Thus the \( a_n \) given above is the best possible choice for the coefficient at all \( N \).

\subsection{Legendre's Equation}
Legendre's equation is
\[
	(1-x^2)y'' - 2xy' + \lambda y = 0
\]
on \( [-1,1] \), with boundary conditions that \( y \) is finite at \( x = \pm 1 \), at the regular singular points of the ODE.\@
This equation is already in Sturm-Liouville form with
\[
	p=1-x^2, q=0, w=1
\]
We seek a power series solution centred on \( x = 0 \):
\[
	y = \sum_n c_n x^n
\]
Substituting into the differential equation,
\[
	(1-x^2) \sum_n n(n-1) x_n x^{n-2} - 2x \sum_n c_n c^{n-1} + \lambda \sum_n c_n x^n = 0
\]
Equating powers,
\[
	(n+2)(n+1)c_{n+2} - n(n-1)c_n - 2n c_n + \lambda c_n = 0
\]
which gives a recursion relation between \( c_{n+2} \) and \( c_n \).
\[
	c_{n+2} = \frac{n(n+1) - \lambda}{(n+1)(n+2)} c_n
\]
Hence, specifying \( c_0, c_1 \) gives two independent solutions.
In particular,
\[
	y_{\text{even}} = c_0 \qty[1 + \frac{(-\lambda)}{2!}x^2 + \frac{(6-\lambda)(-\lambda)}{4!} x^4 + \dots]
\]
\[
	y_{\text{odd}} = c_1 \qty[x + \frac{(2-\lambda)}{3!}x^3 + \dots]
\]
As \( n \to \infty \), \( \frac{c_{n+2}}{c_n} \to 1 \).
So these are geometric series, with radius of convergence \( \abs{x} < 1 \), hence there is divergence at \( x = \pm 1 \).
So taking a power series does not give a useful solution.

Suppose we chose \( \lambda = \ell (\ell + 1) \).
Then eventually we have \( n \) such that the numerator vanishes.
In particular, by taking \( \lambda = \ell (\ell + 1) \), either the series for \( y_{\text{even}} \) or \( y_{\text{odd}} \) terminates.
These functions are called the Legendre polynomials, denoted \( P_\ell(x) \), with the normalisation convention \( P_\ell(1) = 1 \).
\begin{itemize}
	\item \( \ell = 0, \lambda = 0, P_0(x) = 1 \)
	\item \( \ell = 1, \lambda = 2, P_1(x) = x \)
	\item \( \ell = 2, \lambda = 6, P_2(x) = \frac{3x^2 - 1}{2} \)
	\item \( \ell = 3, \lambda = 12, P_3(x) = \frac{5x^3 - 3x}{2} \)
\end{itemize}
Note, \( P_\ell(x) \) has \( \ell \) zeroes.
The polynomials oscillate in parity.
