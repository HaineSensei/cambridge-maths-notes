\subsection{???}
\begin{definition}
    Let \( A \subseteq B \) be an extension of rings, and let \( \mathfrak a \subseteq A \) be an ideal.
    We say that \( x \in B \) is integral over \( \mathfrak a \) if
    \[ x^n + a_1 x^{n-1} + \dots + a_n x^0 = 0 \]
    for some \( a_1, \dots, a_n \in \mathfrak a \).
    The \emph{integral closure} of \( \mathfrak a \) in \( B \) is the set of elements of \( B \) that are integral over \( \mathfrak a \).
\end{definition}
\begin{proposition}
    Let \( A \subseteq B \) be an extension of rings, and let \( \overline A \) be the integral closure of \( A \) in \( B \).
    Let \( \mathfrak a \) be an ideal of \( A \).
    Then the integral closure of \( \mathfrak a \) in \( B \) is \( \sqrt{\mathfrak a \overline A} \), the radical in \( \overline A \) of the extension of \( \mathfrak a \) to \( \overline A \).
\end{proposition}
\begin{proof}
    If \( b \in B \) is integral over \( \mathfrak a \), then
    \[ b^n + a_1 b^{n-1} + \dots + a_n b^0 = 0;\quad a_i \in \mathfrak a \]
    In particular, \( \mathfrak b \) lies in \( \overline A \), and so all of its powers lie in \( \overline A \) as \( \overline A \) is a ring.
    Using the integrality equation for \( b \), we observe that \( b^n \in \mathfrak a \overline A \), hence \( b \in \sqrt{\mathfrak a \overline A} \).
    
    Now, suppose \( b \in \sqrt{\mathfrak a \overline A} \).
    Then \( b^n \in \mathfrak a \overline A \) for some \( n \), so
    \[ b^n = \sum_{i=1}^m a_i x_i;\quad a_i \in \mathfrak a, x_i \in \overline A \]
    Define \( M = A[x_1, \dots, x_m] \).
    The generators lie in \( \overline A \), so \( M \) is an \( A \)-algebra generated by finitely many integral elements over \( A \).
    Hence \( M \) is a finite \( A \)-algebra.
    Note that \( b^n M \subseteq \mathfrak a M \) by the equation for \( b^n \), thought of as an extension of \( A \)-modules.

    Now define \( f : M \to M \) by multiplication by \( b^n \).
    This satisfies \( f(M) \subseteq \mathfrak a M \), and \( f \) is \( A \)-linear.
    Thus by the Cayley--Hamilton theorem,
    \[ f^\ell + \alpha_1 f^{\ell - 1} + \dots + \alpha_\ell f^0 = 0 \in \End_R M;\quad \alpha_i \in \mathfrak a \]
    Evaluating this at \( 1_A \in M \),
    \[ b^{m\ell} + \alpha_1 b^{m(\ell - 1)} + \dots + \alpha_\ell b^0 = 0 \in B \]
    This is an integrality relation for \( b \) is \( \mathfrak a \)-integral.
\end{proof}
Hence, the integral closure of an ideal is closed under sums and products.
\begin{corollary}
    Let \( A \subseteq B \) be an extension of rings, and let \( \mathfrak a \) be an ideal of \( A \).
    Then \( b \in B \) is \( \mathfrak a \)-integral if and only if \( b \) is \( \sqrt{\mathfrak a} \)-integral.
\end{corollary}
\begin{proof}
    By the previous proposition, it suffices to show that
    \[ \sqrt{\mathfrak a \overline A} = \sqrt{\sqrt{\mathfrak a}\, \overline A} \]
    The forwards inclusion is clear.
    For the other direction, it is a general fact that \( \sqrt{I}^e \subseteq \sqrt{I^e} \), so
    \[ \sqrt{\mathfrak a} \overline A \subseteq \sqrt{\mathfrak a \overline A} \]
    Taking radicals on both sides,
    \[ \sqrt{\sqrt{\mathfrak a}\, \overline A} \subseteq \sqrt{\sqrt{\mathfrak a \overline A}} = \sqrt{\mathfrak a \overline A} \]
\end{proof}
\begin{proposition}
    Let \( A \) be an integrally closed integral domain (in its field of fractions).
    Let \( A \subseteq B \) be an extension of rings, let \( \mathfrak a \) be an ideal in \( A \), and let \( a \in B \).
    The following are equivalent:
    \begin{enumerate}
        \item \( b \) is integral over \( \mathfrak a \);
        \item \( b \) is algebraic over \( FF(A) \) with minimal polynomial over \( FF(A) \) of the form
        \[ T^n + a_1 T^{n-1} + \dots + a_n T^0 = 0;\quad a_i \in \sqrt{\mathfrak a} \]
    \end{enumerate}
\end{proposition}
Note that there is an embedding \( FF(A) \subseteq FF(B) \).
\begin{proof}
    Suppose (ii) holds.
    Then \( b \) is integral over \( \sqrt{\mathfrak a} \) by definition.
    Thus, by the above corollary, \( b \) is integral over \( \mathfrak a \).

    Now suppose (i) holds.
    We have an integrality equation
    \[ b^n + a_1 b^{n-1} + \dots + a_n b^0 = 0;\quad a_i \in \mathfrak a \]
    Define
    \[ h = T^n + a_1 T^{n-1} + \dots + a_n T^0 \in (FF(A))[T] \]
    so \( h(b) = 0 \), so certainly \( b \) is algebraic over \( FF(A) \).
    Let \( f \in (FF(A))[T] \) be the minimal polynomial of \( b \) over \( FF(A) \).
    Let \( FF(A) \subseteq \Omega \) where \( \Omega \) is an algebraically closed field, so
    \[ f = \prod_{i=1}^\ell (T - \alpha_i);\quad \alpha_1 = b, \alpha_i \in \Omega \]
    We want to show that the coefficients of \( f \) are in \( \sqrt{\mathfrak a} \).
    By the previous proposition, together with the fact that \( A \) is integrally closed, the integral closure of \( \mathfrak a \) in \( FF(A) \) is \( \sqrt{\mathfrak a} \subseteq A \).
    So it suffices to show that the coefficients of \( f \) lie in \( FF(A) \) and are integrally closed in \( A \).
    As \( f \) is the minimal polynomial over \( FF(A) \), the first part holds by definition.

    Expanding brackets in the equation for \( f \), the coefficients of \( f \) are sums of products of the \( \alpha_i \).
    The proposition above implies that the integral closure of \( \mathfrak a \) in \( \Omega \) is closed under sums and products, so it suffices to show that the \( \alpha_i \) are all integral over \( \mathfrak a \).
    As the \( \alpha_i \) and \( b \) have the same minimal polynomial \( f \) over \( FF(A) \), there is an isomorphism of \( FF(A) \)-algebras \( \varphi_i : FF(A)[b] \to FF(A)[\alpha_i] \) that maps \( b \) to \( \alpha_i \).
    Then as \( h(b) = 0 \) and \( h \in (FF(A))[T] \), we must have \( h(\alpha_i) = h(\varphi_i(b)) = \varphi_i(h(b)) = \varphi_i(0) = 0 \).
\end{proof}

\subsection{Cohen--Seidenberg theorems}
If \( A \subseteq B \) is an extension of rings, the inclusion \( \iota : A \to B \) gives rise to \( \iota^\star : \Spec B \to \Spec A \) given by \( \iota(\mathfrak q) = \mathfrak q \cap A \).
We will study the fibres of this induced map on spectra.
\begin{proposition}[incomparability]
    Let \( A \subseteq B \) be an integral extension, and let \( \mathfrak q, \mathfrak q' \) be prime ideals of \( B \).
    Suppose that \( \mathfrak q \) and \( \mathfrak q' \) contract to the same prime ideal \( \mathfrak p = \mathfrak q \cap A = \mathfrak q' \cap A \) of \( A \), and that \( \mathfrak q \subseteq \mathfrak q' \).
    Then \( \mathfrak q = \mathfrak q' \).
\end{proposition}
We will write \( B_{\mathfrak p} \) for \( (A \setminus \mathfrak p)^{-1} B \), but this is not in general a ring.
\begin{proof}
    Define \( S = A \setminus \mathfrak p \).
    Then \( \mathfrak q \) and \( \mathfrak q' \) are prime ideals of \( B \) not intersecting \( S \).
    Hence \( \mathfrak q = (S^{-1} \mathfrak q)^c \), where \( S^{-1} \mathfrak q = \mathfrak q B_{\mathfrak p} \) is the extension of \( \mathfrak q \) to \( S^{-1} B \), due to the bijection
    \[ \qty{\mathfrak p \in \Spec R \mid \mathfrak p \cap S = \varnothing} \leftrightarrow \Spec S^{-1}R \]
    It suffices to show that \( \mathfrak q B_{\mathfrak p} = \mathfrak q' B_{\mathfrak p} \), as then they are the contractions of the same ideal.
    Note that
    \[ \mathfrak q B_{\mathfrak p} \cap A_{\mathfrak p} = S^{-1} \mathfrak q \cap S^{-1} A = S^{-1} (\mathfrak q \cap A) = S^{-1} \mathfrak p = \mathfrak p A_{\mathfrak p} \]
    Similarly, \( \mathfrak q' B_{\mathfrak p} \cap A_{\mathfrak p} = \mathfrak p A_{\mathfrak p} \), which is a maximal ideal of \( A_{\mathfrak p} \).
    As \( A \subseteq B \) is an integral extension, \( A_{\mathfrak p} \subseteq B_{\mathfrak p} \) is also an integral extension.
    Recall that the contraction of a maximal ideal is maximal in such an extension.
    Now, \( \mathfrak q B_{\mathfrak p} \subseteq \mathfrak q' B_{\mathfrak p} \) are maximal ideals of \( B_{\mathfrak p} \), so they must coincide.
\end{proof}
