\subsection{Skolem functions}
\begin{definition}
    Let \( \mathcal T \) be an \( \mathcal L \)-theory, and let \( \varphi(\vb x, y) \) be an \( \mathcal L \)-formula where \( \vb x \) is nonempty.
    A \emph{Skolem function} for \( \varphi \) is an \( \mathcal L \)-term \( t \) such that
    \[ \mathcal T \vdash \forall \vb x.\, (\exists y.\, \varphi(\vb x, y) \Rightarrow \varphi(\vb x, t(\vb x))) \]
    A \emph{skolemisation} of an \( \mathcal L \)-theory \( \mathcal T \) is a language \( \mathcal L^+ \supseteq \mathcal L \) and an \( \mathcal L^+ \)-theory \( \mathcal T^+ \supseteq \mathcal T \) such that
    \begin{enumerate}
        \item every \( \mathcal L \)-structure that models \( \mathcal T \) can be expanded to an \( \mathcal L^+ \)-structure that models \( \mathcal T^+ \);
        \item \( \mathcal T^+ \) has Skolem functions for any \( \mathcal L^+ \)-formula \( \varphi(\vb x, y) \) where \( \vb x \) is nonempty.
    \end{enumerate}
    A theory is called a \emph{Skolem theory} if it is a skolemisation of itself.
\end{definition}
By `expanded', we mean that \( \mathcal T \) is given interpretations to the elements of \( \mathcal L^+ \setminus \mathcal L \), but no new objects are added.
\begin{proposition}
    Let \( \mathcal T \) be an \( \mathcal L \)-theory, and let \( \mathcal F \) be a collection of \( \mathcal L \)-formulae including all atomic formulae and closed under Boolean operations.
    Suppose that for every formula \( \psi(\vb x, y) \in \mathcal F \), there exists \( \varphi(\vb x) \in \mathcal F \) with
    \[ T \vdash \forall \vb x.\, (\exists y,\. \psi(\vb x, y) \Leftrightarrow \varphi(\vb x)) \]
    Then, every \( \mathcal L \)-formula is equivalent to one in \( \mathcal F \) with the same free variables modulo \( \mathcal T \) (that is, \( \mathcal T \) proves they are equivalent).
\end{proposition}
This is proven on the first example sheet.
% TODO: just do the proof here
\begin{proposition}
    Let \( \mathcal T \) be a Skolem theory.
    Then,
    \begin{enumerate}
        \item every \( \mathcal L \)-formula \( \varphi(\vb x) \) where \( \vb x \) is nonempty is equivalent modulo \( \mathcal T \) to some quantifier-free \( \varphi^\star(\vb x) \);
        \item if \( \mathcal N \vDash \mathcal T \) and \( X \subseteq \mathcal N \), then either \( \langle X \rangle_{\mathcal N} = \varnothing \) or \( \langle X \rangle_{\mathcal N} \preceq \mathcal N \).
    \end{enumerate}
\end{proposition}
\begin{remark}
    When \( \mathcal N \) is a model of a Skolem theory, \( \langle X \rangle_{\mathcal N} \) is sometimes called the \emph{Skolem hull} of \( X \).
\end{remark}
\begin{proof}
    \emph{Part (i).}
    Clearly, \( \varphi(\vb x, t(\vb x)) \Rightarrow \exists y.\, \varphi(\vb x, y) \) in any model.
    So having Skolem functions mean that
    \[ T \vdash \forall \vb x.\, (\exists y.\, \varphi(\vb x, y) \Leftrightarrow \varphi(\vb x, t(\vb x))) \]
    completing the proof by the previous proposition.

    \emph{Part (ii).}
    We proceed by the Tarski--Vaught test.
    Let \( \mathcal M = \langle X \rangle_{\mathcal N}, \vb m \in \mathcal M \), and let \( \varphi(\vb x, y) \) be such that
    \[ \mathcal N \vDash \exists y.\, \varphi(\vb m, y) \]
    Then as \( \mathcal N \) has Skolem functions, there exists an \( \mathcal L \)-term \( t \) such that
    \[ \mathcal N \vDash \varphi(\vb m, t(\vb m)) \]
    But \( \mathcal M \) is closed under the interpretation of function symbols as it is a substructure, so \( t(\vb m) \in \mathcal M \).
    Thus
    \[ \mathcal M \vDash \exists y.\, \varphi(\vb m, y) \]
    as required.
\end{proof}

\subsection{Skolemisation theorem}
\begin{theorem}
    Every first-order language \( \mathcal L \) can be expanded to some \( \mathcal L^+ \supseteq \mathcal L \) that includes an \( \mathcal L^+ \)-theory \( \Sigma \) such that
    \begin{enumerate}
        \item \( \Sigma \) is a Skolem \( \mathcal L^+ \)-theory;
        \item any \( \mathcal L \)-structure can be expanded to an \( \mathcal L^+ \)-structure that models \( \Sigma \); and
        \item \( \abs{\mathcal L^+} = \abs{\mathcal L} \).
    \end{enumerate}
\end{theorem}
\begin{proof}
    We will design \( \mathcal L^+ \) to include Skolem functions for each suitable formula.
    If \( \chi(\vb x, y) \) is an \( \mathcal L \)-formula with \( \vb x \) nonempty, we add a function symbol \( F_\chi \) of arity \( \abs{\vb x} \).
    Performing this for all \( \mathcal L \)-formulae of this form, we obtain a language \( \mathcal L' \supseteq \mathcal L \).
    Next, define \( \Sigma(\mathcal L) \) to be the set of \( \mathcal L \)-sentences that enforce the correct behaviour of the \( F_\chi \):
    \[ \forall \vb x.\, (\exists y.\, \chi(\vb x, y) \Rightarrow \chi(\vb x, F_\chi(\vb x))) \]
    Note that \( \Sigma(\mathcal L) \) is an \( \mathcal L' \)-theory, not an \( \mathcal L \)-theory; there may be existentials in \( \mathcal L' \) without explicit witnesses.
    We can overcome this issue by iterating this construction \( \omega \) times and taking the union.
    Formally, we recursively define
    \[ \mathcal L_0 = \mathcal L;\quad \mathcal L_{n+1} = \mathcal L_n';\quad \Sigma_0 = \varnothing; \quad \Sigma_{n+1} = \Sigma_n \cup \Sigma(\mathcal L_n) \]
    Then we can set
    \[ \mathcal L^+ = \bigcup_{n < \omega} \mathcal L_n;\quad \Sigma = \bigcup_{n < \omega} \Sigma_n \]
    First, note that \( \Sigma \) is a Skolem theory.
    This is because each \( \mathcal L^+ \)-formula is in \( \mathcal L_n \) for some \( n < \omega \), so \( \Sigma_{n+1} \subseteq \Sigma \) asserts that it has a Skolem function.
    It is also clear to see that \( \abs{\mathcal L^+} = \abs{\mathcal L} \) using basic cardinal arithmetic.

    To prove property (ii), it suffices to show that each \( \mathcal L \)-theory can be expanded into an \( \mathcal L' \)-theory that models \( \Sigma(\mathcal L) \); we can then proceed by induction.
    Note that this argument will use the axiom of choice.
    Let \( \mathcal M \) be an \( \mathcal L \)-structure.
    We can assume \( \mathcal M \neq \varnothing \); if \( \mathcal M = \varnothing \) then all sentences in \( \Sigma \) would be vacuously true and there would be nothing to prove.
    We now expand \( \mathcal M \) into an \( \mathcal L' \)-structure \( \mathcal M \) in the following way.
    Consider \( \chi(\vb x, y) \) where \( \vb x \) is nonempty and \( \vb m \in \mathcal M \).
    If
    \[ \mathcal M \vDash \exists b.\, \chi(\vb m, b) \]
    then we can choose such a \( b \) and interpret \( F_\chi(\vb m) \) as this value.
    If
    \[ \mathcal M \nvDash \exists b.\, \chi(\vb m, b) \]
    then we interpret \( F_\chi(\vb m) \) as an arbitrary model element, say, \( \vb m_0 \).
    By construction, \( \mathcal M' \) models \( \Sigma(\mathcal L) \).
\end{proof}
\begin{corollary}
    Any \( \mathcal L \)-theory \( \mathcal T \) admits a skolemisation \( \mathcal T^+ \) in a language \( \mathcal L^+ \) of the same size as \( \mathcal L \).
\end{corollary}
\begin{proof}
    Take \( \mathcal T^+ = \mathcal T \cup \Sigma \).
    Any model of \( \mathcal T^+ \) models \( \Sigma \), so \( \mathcal T^+ \) has Skolem functions.
    Moreover, any \( \mathcal L \)-structure that models \( \mathcal T \) can be extended to one that models \( \Sigma \), which will therefore model \( \mathcal T^+ \).
\end{proof}
\begin{corollary}[downward L\"owenheim--Skolem theorem]
    Let \( \mathcal M \) be an \( \mathcal L \)-structure, and let \( X \subseteq \mathcal M \).
    Let \( \kappa \) be a cardinal such that
    \[ \abs{\mathcal L} + \abs{X} \leq \kappa \leq \abs{\mathcal M} \]
    Then \( \mathcal M \) has an elementary substructure of size \( \kappa \) that contains \( X \).
\end{corollary}
\begin{proof}
    Let \( X \subseteq Y \subseteq \mathcal M \) and \( \abs{Y} = \kappa \).
    Let \( \mathcal M' \) be an expansion of \( \mathcal M \) to a Skolem theory, and consider the Skolem hull \( \langle Y \rangle_{\mathcal M'} \).
    \( \langle Y \rangle_{\mathcal M'} \) must be an elementary substructure of \( \mathcal M' \) as \( Y \neq \varnothing \).
    Let \( \mathcal N \) be the \( \mathcal L \)-reduct of \( \langle Y \rangle_{\mathcal M'} \).
    Then \( \mathcal N \) is an elementary substructure of \( \mathcal N \), and \( X \subseteq \mathcal N \).
    It remains to check \( \abs{\mathcal N} = \kappa \).
    \[ \abs{\mathcal N} \leq \abs{Y} + \abs{\mathcal L^+} = \kappa + \abs{\mathcal L} = \kappa = \abs{Y} \leq \abs{\mathcal N} \]
    So \( \abs{\mathcal N} = \kappa \).
\end{proof}

\subsection{Elimination sets}
\begin{definition}
    Let \( \mathcal T \) be an \( \mathcal L \)-theory.
    A set \( F \) of \( \mathcal L \)-formulae is an \emph{elimination set} for \( \mathcal T \) if, for every \( \mathcal L \)-formula \( \varphi \), there is a Boolean combination \( \varphi^\star \) of formulae in \( F \) such that
    \[ \mathcal T \vdash \varphi \Leftrightarrow \varphi^\star \]
    A theory \( \mathcal T \) has \emph{quantifier elimination} if the family of quantifier-free formulae forms an elimination set for \( \mathcal T \).
\end{definition}
Note that a theory having quantifier elimination depends on its underlying language.
Every Skolem theory has quantifier elimination.
\begin{example}
    \begin{enumerate}
        \item Let \( p \in \mathbb C[x] \) be the polynomial \( x^3 - 31x^2 + 6 \) over \( \mathbb C \).
        The sentence \( \exists x.\, p(x) = 0 \) contains a quantifier.
        But as \( \mathbb C \) is algebraically closed, it is equivalent to the quantifier-free sentence \( 1 \neq 0 \vee (-31) \neq 0 \).
        \item A real-valued matrix is invertible if there exists a two-sided inverse.
        This has a quantifier, but there is a quantifier-free sentence equivalent to it, namely, `its determinant is nonzero'.
    \end{enumerate}
\end{example}
\begin{remark}
    \begin{enumerate}
        \item We can check if two models of \( \mathcal T \) are elementarily equivalent by considering just those formulae in an elimination set.
        \item In particular, to check if a theory is complete, it suffices to check that all sentences in an elimination set are either deducible from the theory or inconsistent with it.
        \item Suppose \( \mathcal L \) is a recursive language, and the map \( \varphi \mapsto \varphi^\star \) is computable.
        Then an algorithm to decide whether \( \mathcal T \) proves any sentence can be produced from one that operates only on the elimination set.
        \item The elementary embeddings \( \mathcal M \hookrightarrow \mathcal N \) are precisely those embeddings that preserve \( \varphi \) and \( \neg \varphi \) for all \( \varphi \) in \( F \).
        So a theory with quantifier elimination is model-complete. % why? check. also check why we need \neg \varphi
        \item The definable sets of a model are precisely the Boolean combinations of sets definable with only formulae in an elimination set.
    \end{enumerate}
\end{remark}
In the next result, we use the notation \( \neg F \) for the set of negations of formulae in \( F \).
\begin{proposition}[syntactic quantifier elimination]
    Let \( \mathcal T \) be an \( \mathcal L \)-theory, and let \( F \) be a family of \( \mathcal L \)-formulae including all atomic formulae.
    Suppose that, for every \( \mathcal L \)-formula of the form
    \[ \theta(\vb x) = \exists y.\, \bigwedge_{i < n} \varphi_i(\vb x, y);\quad \varphi_i \in F \cup \neg F \]
    there exists a Boolean combination \( \theta^\star(\vb x) \) of formulae in \( F \) such that
    \[ \mathcal T \vdash \forall \vb x.\, (\theta(\vb x) \Leftrightarrow \theta^\star(\vb x)) \]
    Then \( F \) is an elimination set for \( \mathcal T \).
\end{proposition}
The proof is similar to a previous proposition.
\begin{example}
    Consider the theory \( \mathcal T_\infty \) of infinite sets in the language with empty signature.
    The only atomic formulae are equalities, and the only terms in the language are variables.
    Using the above proposition, it suffices to eliminate the existential quantifier in formulae \( \varphi(x_0, \dots, x_{n-1}) \) of the form
    \[ \exists y.\, \qty(\bigwedge_{i \in I} y = x_i) \wedge \qty(\bigwedge_{i \in J} y \neq x_i) \wedge \qty(\bigwedge_{i, j \in K} x_i = x_j) \wedge \qty(\bigwedge_{i, j \in L} x_i \neq x_j) \]
    where \( I, J, K, L \subseteq \qty{0, \dots, n-1} \).
    Without loss of generality we can assume \( I \) is empty, as we can easily remove the quantifier in this situation.
    We may also push the quantifier inside the first conjunct.
    \[ \qty(\exists y.\, \bigwedge_{i \in J} y \neq x_i) \wedge \psi(x_0, \dots, x_{n-1});\quad \psi(x_0, \dots, x_{n-1}) = \qty(\bigwedge_{i, j \in K} x_i = x_j) \wedge \qty(\bigwedge_{i, j \in L} x_i \neq x_j) \]
    But the theory of infinite sets proves \( \exists y.\, \bigwedge_{i \in J} y \neq x_i \), so we can conclude that \( \varphi \) and \( \psi \) are equivalent modulo \( \mathcal T \).
\end{example}

\subsection{???}
\begin{definition}
    Let \( \mathcal M \) and \( \mathcal N \) be \( \mathcal L \)-structures.
    We write \( \mathcal M \Rightarrow_1 \mathcal N \) if every existential sentence modelled by \( \mathcal M \) is also modelled by \( \mathcal N \).
\end{definition}
\begin{theorem}[existential amalgamation]
    Let \( \mathcal M \) and \( \mathcal N \) be \( \mathcal L \)-structures, with \( S \subseteq \mathcal M \).
    Suppose there is a homomorphism \( f : \langle S \rangle_{\mathcal M} \to \mathcal N \) such that \( (\mathcal N, f(S)) \Rightarrow_1 (\mathcal M, S) \).
    Then there is an elementary extension \( \mathcal K \) of \( \mathcal N \) and an embedding \( g : \mathcal M \hookrightarrow \mathcal K \) making the following diagram commute.
\[\begin{tikzcd}
	& {\mathcal K} \\
	{\mathcal M} && {\mathcal N} \\
	& {\langle S \rangle_{\mathcal M}}
	\arrow[hook, from=3-2, to=2-1]
	\arrow["\preceq", hook, from=2-1, to=1-2]
	\arrow["f"', from=3-2, to=2-3]
	\arrow["g"', hook, from=2-3, to=1-2]
\end{tikzcd}\]
\end{theorem}
% The proof is as in elementary amalgamation theorem. Exercise.
We can make the following more general definition.
\begin{definition}
    A class \( \mathbb K \) of \( \mathcal L \)-structures has the \emph{amalgamation property} if, given a diagram of elements of \( \mathbb K \)
    % https://q.uiver.app/#q=WzAsMyxbMSwxLCJcXG1hdGhjYWwgQyJdLFswLDAsIlxcbWF0aGNhbCBCIl0sWzIsMCwiXFxtYXRoY2FsIEEiXSxbMCwxLCIiLDAseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFswLDIsIiIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV1d
    \[\begin{tikzcd}
        {\mathcal B} && {\mathcal A} \\
        & {\mathcal C}
        \arrow[hook, from=2-2, to=1-1]
        \arrow[hook, from=2-2, to=1-3]
    \end{tikzcd}\]
    there is a structure \( \mathcal D \) in \( \mathbb K \) and embeddings making the following diagram commute.
    % https://q.uiver.app/#q=WzAsNCxbMSwyLCJcXG1hdGhjYWwgQyJdLFswLDEsIlxcbWF0aGNhbCBCIl0sWzIsMSwiXFxtYXRoY2FsIEEiXSxbMSwwLCJcXG1hdGhjYWwgRCJdLFswLDEsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzAsMiwiIiwyLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbMiwzLCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFsxLDMsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV1d
    \[\begin{tikzcd}
        & {\mathcal D} \\
        {\mathcal B} && {\mathcal A} \\
        & {\mathcal C}
        \arrow[hook, from=3-2, to=2-1]
        \arrow[hook, from=3-2, to=2-3]
        \arrow[hook, from=2-3, to=1-2]
        \arrow[hook, from=2-1, to=1-2]
    \end{tikzcd}\]
\end{definition}
\begin{definition}
    Let \( \mathbb K \) be a class of \( \mathcal L \)-structures and \( \mathcal M \in \mathbb K \).
    We say that \( \mathcal M \) is \emph{existentially closed in \( \mathbb K \)} if, for every existential formula \( \psi(\vb x) \) and tuple \( \vb m \in \mathcal M \), the existence of an extension \( \mathcal M \subseteq \mathcal N \in \mathbb K \) with \( \mathcal N \vDash \psi(\vb m) \) forces \( \mathcal M \vDash \psi(\vb m) \).
\end{definition}
\begin{example}
    \begin{enumerate}
        \item Every field that is existentially closed in the class of fields is algebraically closed.
        Let \( A \) be an existentially closed field, and view a nontrivial polynomial \( f(\vb y) \) over \( A \) as a statement \( p(\vb a, y) \) where \( p(\vb x, y) \) is a term in the language of rings, and \( \vb a \) is a tuple.
        For instance, \( y^2 + 2y - 3 \) can be seen as \( p(1, 2, 3, y) \), where \( p(x_0, x_1, x_2, y) = x_0 y^2 + x_1 y + (-x_2) \).
        We can replace \( f \) with an irreducible factor and consider the quotient ring \( \faktor{A[y]}{(f)} \), which is an extension of \( A \) over which \( f \) has a root.
        \[ \faktor{A[y]}{(f)} \vDash \exists y.\, p(\vb a, y) = 0 \]
        Since \( f \) is irreducible, this is an extension of fields.
        Thus, as \( A \) is existentially closed,
        \[ A \vDash \exists y.\, p(\vb a, y) = 0 \]
        so \( f \) has a root in \( A \).
        The converse is true, and is one way that Hilbert's Nullstellensatz can be stated.
        \item The existentially closed linear orders are precisely the dense linear orders without endpoints.
        \item The existentially closed ordered fields are precisely the \emph{real closed fields}, which are the ordered fields elementarily equivalent to the real numbers.
        Equivalently, all nonnegative elements are squares, and all odd-degree elements have a root.
    \end{enumerate}
\end{example}
\begin{theorem}
    Let \( \mathbb K \) be a class of \( \mathcal L \)-structures that is closed under isomorphism.
    Suppose that the class of all of the substructures of the structures in \( \mathbb K \) has the amalgamation property.
    Then, every existential \( \mathcal L \)-formula \( \varphi(\vb x) \) is equivalent to a quantifier-free \( \mathcal L \)-formula in all existentially closed structures in \( \mathbb K \).
    In particular, if \( \mathcal T \) is a theory axiomatising existentially closed structures in \( \mathbb K \), then \( \mathcal T \) has quantifier elimination.
\end{theorem}
\begin{proof}
    Let \( \varphi(\vb x) \) be an existential formula.
    We will call a pair \( (\mathcal M, \vb m) \) a \emph{witnessing pair} if \( \mathcal M \) is existentially closed in \( \mathbb K \) and \( \mathcal M \vDash \varphi(\vb m) \).
    For each such pair, let
    \[ \theta_{(\mathcal M, \vb m)} = \bigwedge \qty{\psi \text{ a literal} \mid \mathcal M \vDash \psi(\vb m)} \]
    where the \emph{literals} are the atomic formulae and their negations.
    Let
    \[ \chi(\vb x) = \bigvee \theta_{(M, \vb m)}(\vb x) \]
    Note that the \( \theta \) and \( \chi \) are not first-order formulae.
    It suffices to show that if \( \mathcal N \) is existentially closed in \( \mathbb K \) then
    \[ \mathcal N \vDash \varphi(\vb n) \iff \mathcal N \vDash \chi(\vb n) \]
    If \( \vb n \in \mathcal N \) is such that \( \mathcal N \vDash \varphi(\vb n) \), then \( (\mathcal N, \vb n) \) is a witnessing pair, and thus \( \mathcal N \vDash \chi(\vb n) \) by construction.
    For the converse, if \( \mathcal N \vDash \chi(\vb n) \), there is a witnessing pair \( (\mathcal M, \vb m) \) such that \( \mathcal N \vDash \theta_{(\mathcal M, \vb m)}(\vb n) \).
    Hence, for each literal \( \psi(\vb x) \),
    \[ (\mathcal M \vDash \psi(\vb m)) \implies (\mathcal N \vDash \psi(\vb n)) \]
    There is thus an embedding \( e : \langle \vb m \rangle_{\mathcal M} \hookrightarrow \mathcal N \) mapping \( \vb m \) to \( \vb n \).
    Applying the amalgamation property, we obtain
    % https://q.uiver.app/#q=WzAsNSxbMSwzLCJcXGxhbmdsZSBcXHZiIG0gXFxyYW5nbGVfe1xcbWF0aGNhbCBNfSJdLFswLDIsIlxcbWF0aGNhbCBNIl0sWzIsMiwiXFxtYXRoY2FsIE4iXSxbMSwxLCJcXG1hdGhjYWwgQyJdLFsxLDAsIlxcbWF0aGNhbCBEIl0sWzAsMSwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbMiwzLCIiLDIseyJzdHlsZSI6eyJ0YWlsIjp7Im5hbWUiOiJob29rIiwic2lkZSI6InRvcCJ9fX1dLFsxLDMsIiIsMCx7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzAsMiwiZSIsMix7InN0eWxlIjp7InRhaWwiOnsibmFtZSI6Imhvb2siLCJzaWRlIjoidG9wIn19fV0sWzMsNCwiIiwwLHsic3R5bGUiOnsidGFpbCI6eyJuYW1lIjoiaG9vayIsInNpZGUiOiJ0b3AifX19XSxbMiw0LCJoIiwyLHsiY3VydmUiOjIsInN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFsxLDQsImciLDAseyJjdXJ2ZSI6LTIsInN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	& {\mathcal D} \\
	& {\mathcal C} \\
	{\mathcal M} && {\mathcal N} \\
	& {\langle \vb m \rangle_{\mathcal M}}
	\arrow[hook, from=4-2, to=3-1]
	\arrow[hook, from=3-3, to=2-2]
	\arrow[hook, from=3-1, to=2-2]
	\arrow["e"', hook, from=4-2, to=3-3]
	\arrow[hook, from=2-2, to=1-2]
	\arrow["h"', curve={height=12pt}, dashed, from=3-3, to=1-2]
	\arrow["g", curve={height=-12pt}, dashed, from=3-1, to=1-2]
\end{tikzcd}\]
    where \( \mathcal D \in \mathbb K \), and both \( \mathcal M, \mathcal N \) embed into \( \mathcal C \) and therefore into \( \mathcal D \).
    Note that \( g(\vb m) = h(\vb n) \).
    Replacing \( \mathcal D \) with an isomorphic copy if required, we may assume that \( h \) is an inclusion, so \( g(\vb m) = \vb n \).
    We know that \( (\mathcal M, \vb m) \) is a witnessing pair, so \( \mathcal M \vDash \varphi(\vb m) \).
    Then \( \mathcal D \vDash \varphi(g(\vb m)) \) as existential formulae are preserved under taking extensions.
    Since \( \mathcal N \) is existentially closed in \( \mathbb K \), \( \mathcal D \in \mathbb K \), and \( \mathcal N \subseteq \mathcal D \), we conclude that \( \mathcal N \vDash \varphi(g(\vb m)) \) so \( \mathcal N \vDash \varphi(\vb n) \) as required.
    % then use compactness twice to reduce to first order formula

    In particular, if \( \mathcal T \) is a theory axiomatising existentially closed structures in \( \mathbb K \), then \( \mathcal T \) has quantifier elimination by applying the completeness theorem and then using the syntactic criterion for quantifier elimination proven previously.
\end{proof}
\begin{example}
    We show that the theory \( \mathsf{ACF} \) of algebraically closed fields has quantifier elimination.
    First, recall that \( \mathsf{ACF} \) axiomatises the existentially closed fields, so it suffices to check that the class of substructures of fields has the amalgamation property.
    Note that a substructure of a field must satisfy all universal sentences in the theory of fields, so the substructures of fields are precisely the integral domains.
    General field theory shows that the class of fields has the amalgamation property; we can then prove that the class of integral domains has the amalgamation property by passing to fraction fields.
\end{example}
\begin{example}
    The theory \( \mathsf{DLO} \) of dense linear orders without endpoints has quantifier elimination.
    % The theory of linear orders has a universal axiomatisation, so the 
    % TODO: watch lecture recording to fill in blank: time is 11:15
\end{example}

\subsection{Inductive classes}
\begin{definition}
    A class \( \mathbb K \) of \( \mathcal L \)-structures is \emph{inductive} if it is closed under isomorphisms and under unions of chains of embeddings.
\end{definition}
\begin{theorem}
    Let \( \mathcal M \) be a structure in an inductive class \( \mathbb K \).
    Then \( \mathcal M \subseteq \mathcal N \) for some \( \mathcal N \) existentially closed in \( \mathbb K \).
\end{theorem}
This is analogous to the theorem that every field has an algebraic closure, and is proven in a similar way.
\begin{proof}
    We show that \( \mathcal M \) can be extended to some structure \( \mathcal M^\star \in \mathbb K \) with the property that for all \( \vb m \in \mathcal M \) and \( \varphi(\vb x) \) an existential \( \mathcal L \)-formula, if \( \varphi(\vb m) \) holds in some extension of \( \mathcal M^\star \) in \( \mathbb K \), then \( \varphi(\vb m) \) holds in \( \mathcal M^\star \).

    We now show that this suffices to complete the proof.
    Indeed, we then recursively define a chain of \( \mathbb K \)-structures by setting \( \mathcal M^{(0)} = \mathcal M \) and \( \mathcal M^{(i+1)} = (\mathcal M^{(i)})^\star \), then taking their union to form \( \mathcal N \).
    Then \( \mathcal N \) lies in \( \mathbb K \) as \( \mathbb K \) is inductive, and moreover it extends \( \mathcal M \).
    
    This \( \mathcal N \) is existentially closed in \( \mathbb K \).
    Suppose \( \varphi(\vb x) \) is an existential formula, \( \vb n \in \mathcal N \), and \( \mathcal D \) is a structure in \( \mathbb K \) such that \( \mathcal D \vDash \varphi(\vb n) \).
    As \( \vb n \in \bigcup_{i < \omega} \mathcal M^{(i)} \) and the \( \mathcal M^{(i)} \) form a chain, there must be \( k < \omega \) such that \( \vb n \in \mathcal M^{(k)} \).
    Then \( (\mathcal M^{(k)})^\star = \mathcal M^{(k+1)} \vDash \varphi(\vb n) \), so in particular, \( \mathcal N \vDash \varphi(\vb n) \).

    We now construct \( \mathcal M^\star \).
    Using the axiom of choice, create an ordinal-indexed list of pairs \( (\varphi_\beta, \vb m_\beta)_\beta \) where \( \varphi \) is an existential formula and \( \vb m \in \mathcal M \), and \( \beta \) ranges over all ordinals less than some ordinal \( \delta \).
    We then construct a chain of \( \mathbb K \)-structures by transfinite induction.
    Let \( \mathcal M_0 = \mathcal M \).
    At each successor stage, let \( \mathcal M_{\beta + 1} \) be a \( \mathbb K \)-structure \( \mathcal D \) that extends \( \mathcal M_\beta \) and models \( \varphi_\beta(\vb m_\beta) \), if this exists.
    If such a model does not exist, define \( \mathcal M_{\beta + 1} = \mathcal M_\beta \).
    At each limit stage, let \( \mathcal M_\lambda = \bigcup_{\beta < \lambda} \mathcal M_\beta \).
    Finally, set \( \mathcal M^\star = \mathcal M_\delta \).

    If \( \varphi(\vb x) \) is existential, \( \vb m \in \mathcal M \), and \( \mathcal D \) is some \( \mathbb K \)-structure that extends \( \mathcal M^\star \) and models \( \varphi(\vb m) \), then \( (\varphi, \vb m) = (\varphi_\beta, \vb m_\beta) \) for some \( \beta < \delta \).
    Then \( \mathcal M_\beta \subseteq \mathcal M^\star \subseteq \mathcal D \), so \( \mathcal M_{\beta + 1} \) models \( \varphi_\beta(\vb m_\beta) = \varphi(\vb m) \) by definition.
    But as \( \varphi \) is existential and \( \mathcal M^\star \) extends \( \mathcal M_\beta \), we must also have that \( \mathcal M^\star \) models \( \varphi(\vb m) \), as required.
\end{proof}

\subsection{Interaction with other properties}
\begin{theorem}
    Let \( \mathcal T \) be an \( \mathcal L \)-theory.
    Then the following are equivalent.
    \begin{enumerate}
        \item The theory \( \mathcal T \) is model-complete.
        \item Every model of \( \mathcal T \) is an existentially closed model of \( \mathcal T \).
        \item Given an embedding \( e : \mathcal A \hookrightarrow \mathcal B \) between models of \( \mathcal T \), there is an elementary extension \( \mathcal D \) of \( \mathcal A \) and an embedding \( g : \mathcal B \hookrightarrow D \) such that \( g \circ e = \id_{\mathcal A} \).
        \item If an \( \mathcal L \)-formula \( \varphi(\vb x, \vb y) \) is a conjunction of literals, then \( \exists \vb y.\, \varphi(\vb x, \vb y) \) is equivalent to some universal \( \mathcal L \)-formula \( \psi(\vb x) \) modulo \( \mathcal T \).
        \item Every \( \mathcal L \)-formula is equivalent to some universal \( \mathcal L \)-formula modulo \( \mathcal T \). 
    \end{enumerate}
\end{theorem}
\begin{proof}
    %ES1 Q11
\end{proof}
Let \( \mathcal M, \mathcal N \) be \( \mathcal L \)-structures.
If \( \mathcal M, \mathcal N \) satisfy the same quantifier-free sentences, we write \( \mathcal M \equiv_0 \mathcal N \).
\begin{theorem}
    Let \( \mathcal T \) be an \( \mathcal L \)-theory.
    Then the following are equivalent.
    \begin{enumerate}
        \item \( \mathcal T \) has quantifier elimination.
        \item If \( \mathcal A, \mathcal B \vDash \mathcal T \) and \( \vb a \in \mathcal A, \vb b \in \mathcal B \) are tuples of the same length, then \( (\mathcal A, \vb a) \equiv_0 (\mathcal B, \vb b) \) implies \( (\mathcal A, \vb a) \Rightarrow_1 (\mathcal B, \vb b) \).
        \item Whenever \( \mathcal A, \mathcal B \vDash \mathcal T \), \( S \subseteq \mathcal A \) and \( e : \langle S \rangle_{\mathcal A} \hookrightarrow \mathcal B \), then there is an elementary extension \( \mathcal D \) of \( \mathcal B \) and an embedding \( f : \mathcal A \hookrightarrow \mathcal D \) extending \( e \).
        \item \( \mathcal T \) is model-complete and \( \mathcal T_\forall \) has the amalgamation property.
        \item For every quantifier-free \( \mathcal L \)-formula \( \varphi(\vb x, y) \), the formula \( \exists y.\, \varphi(\vb x, y) \) is \( \mathcal T \)-equivalent to a quantifier-free formula \( \psi(\vb x) \).
    \end{enumerate}
\end{theorem}
\begin{proof}
    (i) implies (ii) is clear.
    
    \emph{(ii) implies (iii).}
    It suffices to show that \( (\mathcal A, \vb a) \Rightarrow_1 (\mathcal B, e(\vb a)) \) by the existential amalgamation theorem.
    Since a sentence in \( \mathcal L_S \) is finite, it can only mention finitely many of the new constants in \( S \), so it is enough to check that \( (\mathcal A, \vb a) \Rightarrow_1 (\mathcal B, e(\vb a)) \) for all tuples \( \vb a \) obtainable from \( S \).
    Now, if \( \vb a \) is such a tuple and \( e : \langle S \rangle_{\mathcal A} \hookrightarrow \mathcal B \) is an embedding, then \( (\mathcal A, \vb a) \equiv_0 (\mathcal B, e(\vb a)) \), giving the required result by (ii).
\end{proof}
